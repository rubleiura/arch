# ###########################################################
# ## üìã [MANUAL] –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ù–ê–°–¢–†–û–ô–ö–ï –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò GRUB ##
# ###########################################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞—â–∏—Ç–µ –∑–∞–≥—Ä—É–∑—á–∏–∫–∞ GRUB —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–æ–ª—è
#          –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
# üí° –í–∫–ª—é—á–∞–µ—Ç: –ì–µ–Ω–µ—Ä–∞—Ü–∏—é —Ö–µ—à–∞, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 40_custom, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ GRUB.
# üí° –°–æ–≤–º–µ—Å—Ç–∏–º–æ: Arch Linux + UEFI + BTRFS + LUKS + snapper + grub-btrfs.
# üí° –í–∞–∂–Ω–æ: –í—ã–ø–æ–ª–Ω—è—Ç—å –í–†–£–ß–ù–£–Æ, –ø–æ —à–∞–≥–∞–º. –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–π –≤–≤–æ–¥.
# üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—å –≤ –Ω–∞–¥–µ–∂–Ω–æ–º –º–µ—Å—Ç–µ.

# === –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–æ–ª—è –∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è GRUB ===
# –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å Arch Linux + UEFI/BIOS + BTRFS + LUKS + snapper + grub-btrfs
# –ü–æ–≤—ã—à–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∑–∞ —Å—á—ë—Ç —Å–∫—Ä—ã—Ç–æ–≥–æ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ "root")
# –í—ã–ø–æ–ª–Ω—è—Ç—å –í–†–£–ß–ù–£–Æ, –ø–æ —à–∞–≥–∞–º, –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

# –®–∞–≥ 1: –í—ã–±–µ—Ä–∏—Ç–µ –£–ù–ò–ö–ê–õ–¨–ù–û–ï –∏–º—è —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è GRUB
# –≠—Ç–æ –∏–º—è –ù–ï —Å–≤—è–∑–∞–Ω–æ —Å –≤–∞—à–∏–º–∏ —É—á—ë—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏ –≤ Linux.
# –û–Ω–æ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¢–û–õ–¨–ö–û –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ GRUB.
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –∏–º—è (–Ω–µ "admin", –Ω–µ "root").
# –ü—Ä–∏–º–µ—Ä—ã: bootguard, vaultkeeper, syslock, grubmaster2026
#
# –ó–ê–ü–û–ú–ù–ò–¢–ï –∏–ª–∏ –ó–ê–ü–ò–®–ò–¢–ï —ç—Ç–æ –∏–º—è ‚Äî –æ–Ω–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –Ω–∞ –®–∞–≥–µ 3.
#
# –í —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: "bootguard"
# –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–º–µ–Ω–∏—Ç—å –µ–≥–æ –Ω–∞ —Å–≤–æ—ë.

# –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è PBKDF2-—Ö–µ—à–∞ –ø–∞—Ä–æ–ª—è
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

sudo grub-mkpasswd-pbkdf2

# –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—Ä–æ—Å–∏—Ç –ø–∞—Ä–æ–ª—å –¥–≤–∞–∂–¥—ã –∏ –≤—ã–≤–µ–¥–µ—Ç —Ö–µ—à.
# –í–ù–ò–ú–ê–ù–ò–ï: –ø–∞—Ä–æ–ª—å –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –≤–≤–æ–¥–µ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.
# –ö–û–ü–ò–†–£–ô–¢–ï —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫—É, –Ω–∞—á–∏–Ω–∞—é—â—É—é—Å—è —Å "grub.pbkdf2.sha512..."

# –®–∞–≥ 3: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ /etc/grub.d/40_custom
# –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ nano:

sudo nano /etc/grub.d/40_custom

# –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –≤ —Å–∞–º—ã–π –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞.
# –í –ö–û–ù–¶–ï –§–ê–ô–õ–ê –¥–æ–±–∞–≤—å—Ç–µ –¢–û–ß–ù–û –≠–¢–ò –î–í–ï –°–¢–†–û–ö–ò (–∑–∞–º–µ–Ω–∏—Ç–µ 'bootguard' –∏ '–í–ê–®_–•–ï–®_–ó–î–ï–°–¨'):

set superusers="bootguard"
password_pbkdf2 bootguard grub.pbkdf2.sha512.10000.–í–ê–®_–•–ï–®_–ó–î–ï–°–¨

# –ü—Ä–∞–≤–∏–ª–∞:
# - –ó–∞–º–µ–Ω–∏—Ç–µ "bootguard" –Ω–∞ –í–ê–®–ï –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∏–º—è (–¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å –≤ –æ–±–µ–∏—Ö —Å—Ç—Ä–æ–∫–∞—Ö).
# - –ó–∞–º–µ–Ω–∏—Ç–µ "–í–ê–®_–•–ï–®_–ó–î–ï–°–¨" –Ω–∞ —Ö–µ—à –∏–∑ –®–∞–≥–∞ 2.
# - –ù–µ —Å—Ç–∞–≤—å—Ç–µ –∫–∞–≤—ã—á–∫–∏ –≤–æ–∫—Ä—É–≥ —Ö–µ—à–∞.
# - –ù–µ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –ø—Ä–æ–±–µ–ª—ã –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫.
# - –ù–µ —É–¥–∞–ª—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ñ–∞–π–ª–µ.
#
# –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:
#   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å:    Ctrl+O ‚Üí Enter
#   - –í—ã–π—Ç–∏:        Ctrl+X

# –®–∞–≥ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ GRUB
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É:
s
udo grub-mkconfig -o /boot/grub/grub.cfg

# –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –ø–µ—Ä–µ—Å–æ–±–µ—Ä—ë—Ç grub.cfg —Å —É—á—ë—Ç–æ–º –Ω–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏ –∏ –ø–∞—Ä–æ–ª—è.
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –≤—ã–≤–æ–¥–µ –µ—Å—Ç—å "Found snapshot ..." ‚Äî –∑–Ω–∞—á–∏—Ç, snapper —Ä–∞–±–æ—Ç–∞–µ—Ç.

# –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

tail -n 3 /etc/grub.d/40_custom

# –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ (—Å –≤–∞—à–∏–º –∏–º–µ–Ω–µ–º –∏ —Ö–µ—à–µ–º):

# set superusers="bootguard"
# password_pbkdf2 bootguard grub.pbkdf2.sha512.10000.–í–ê–®_–•–ï–®...

# ################################################################
# ## ‚úÖ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ù–ê–°–¢–†–û–ô–ö–ï –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò GRUB –ó–ê–í–ï–†–®–ï–ù–ê     ##
# ################################################################
# –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:
# - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: –ë–ï–ó –ø–∞—Ä–æ–ª—è.
# - –í—ã–±–æ—Ä —Å–Ω–∞–ø—à–æ—Ç–∞: –ë–ï–ó –ø–∞—Ä–æ–ª—è.
# - –ù–∞–∂–∞—Ç–∏–µ "e" –∏–ª–∏ "c" –≤ GRUB: –¢–†–ï–ë–£–ï–¢ –ø–∞—Ä–æ–ª—å + –∏–º—è.
#   ‚Üí GRUB –∑–∞–ø—Ä–æ—Å–∏—Ç: "Username:" –∏ "Password:"
#   ‚Üí –í–≤–µ–¥–∏—Ç–µ: bootguard + –≤–∞—à –ø–∞—Ä–æ–ª—å
#
# –≠—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç:
# - –£–≥–∞–¥—ã–≤–∞–Ω–∏—è –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –∏–º–µ–Ω–∏ ("root")
# - –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ç–∞–∫ –Ω–∞ GRUB
# - –û–±—Ö–æ–¥–∞ LUKS —á–µ—Ä–µ–∑ init=/bin/bash
