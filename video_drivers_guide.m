#!/bin/bash

##########################################################################################
## üñ•Ô∏è –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –£–°–¢–ê–ù–û–í–ö–ï –í–ò–î–ï–û–î–†–ê–ô–í–ï–†–û–í –í ARCH LINUX –î–õ–Ø –ü–†–ê–ö–ò–ß–ï–°–ö–û–ì–û –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø   ##
##########################################################################################
#
# ‚ÑπÔ∏è –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤
#              –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ Arch Linux.
# üí° –í–∫–ª—é—á–∞–µ—Ç: –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è Intel, AMD, NVIDIA (–≤–∫–ª—é—á–∞—è –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–µ –∏ nouveau),
#              –Ω–∞—Å—Ç—Ä–æ–π–∫—É –¥–ª—è Wayland, –≥–∏–±—Ä–∏–¥–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏ (switcherooctl),
#              –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã (glmark2, vkcube, nvidia-smi –∏ –¥—Ä.),
#              –∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (TLP).
# ‚ùó –í–∞–∂–Ω–æ: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–∞–∫–µ—Ç–∞, –≤ chroot –∏–ª–∏ –≤ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.
# üîí –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç! –ö–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –±–ª–æ–∫–∞–º–∏ –≤—Ä—É—á–Ω—É—é.

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
#   0. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã
#   1. –í—ã–±–æ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (Intel / AMD / NVIDIA nouveau / NVIDIA Proprietary)
#   2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (Vulkan ICD, VA-API)
#   3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥—É–ª–µ–π –∏ initramfs (—Ç–æ–ª—å–∫–æ –¥–ª—è NVIDIA Proprietary)
#   4. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –Ω–æ—É—Ç–±—É–∫–æ–≤ (TLP)
#   5. –í–æ–∑–≤—Ä–∞—Ç –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –º–∞–∫–µ—Ç—É
#   6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
#   7. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ switcherooctl –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Å–µ–∞–Ω—Å–µ

# üí° –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º –ë–õ–û–ö–ê 12 –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–∞–∫–µ—Ç–∞.
#                –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –µ–≥–æ —Å—Ç—Ä–æ–≥–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ë–õ–û–ö–ê 11.
##################################################################



######################################################
## üîç –ë–õ–û–ö 0: –ü–û–î–ì–û–¢–û–í–ö–ê –ò –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –í–ò–î–ï–û–ö–ê–†–¢–´   ##
######################################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –¢–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–æ–¥–µ–ª—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è GPU.
# ‚ùó –í–∞–∂–Ω–æ: –û—Ç —ç—Ç–æ–≥–æ –∑–∞–≤–∏—Å–∏—Ç –≤—ã–±–æ—Ä –¥—Ä–∞–π–≤–µ—Ä–∞ –∏ –µ–≥–æ –≤–µ—Ä—Å–∏–∏.
# üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: `lspci`, `inxi`, —Å–∞–π—Ç NVIDIA.

# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ chroot –∏–ª–∏ –≤ Live-—Å—Ä–µ–¥–µ:
lspci -nn | grep -i 'vga\|3d\|display'
# –ò–õ–ò (–µ—Å–ª–∏ inxi —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω):
# inxi -G

# üìå –ó–∞–ø–∏—à–∏—Ç–µ:
# - –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è: Intel / AMD / NVIDIA
# - –ú–æ–¥–µ–ª—å –∫–∞—Ä—Ç—ã (–¥–ª—è NVIDIA ‚Äî —É—Ç–æ—á–Ω–∏—Ç–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ: Fermi, Kepler, Maxwell, Pascal, Turing, Ampere, Ada Lovelace –∏ —Ç.–¥.)
# - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –Ω–∞: https://www.nvidia.com/drivers/

# üí° –í–ê–ñ–ù–û –û –ü–û–ö–û–õ–ï–ù–ò–Ø–• NVIDIA:
# - –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–∫–æ–ª–µ–Ω–∏—è (Pascal, Turing, Ampere, Ada Lovelace): –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–µ–∫—É—â–∏–º–∏ Production Branch –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ (`nvidia`, `nvidia-lts`, `nvidia-dkms`).
# - –°—Ç–∞—Ä—ã–µ –ø–æ–∫–æ–ª–µ–Ω–∏—è (Tesla, Fermi, Kepler, Maxwell): –¢—Ä–µ–±—É—é—Ç **—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã**. –ò—Ö –ø–∞–∫–µ—Ç—ã –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ Arch Linux. –ò—Ö –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –≤ AUR (–Ω–∞–ø—Ä–∏–º–µ—Ä, `nvidia-390xx`, `nvidia-470xx`).

#
#
####################################################
## ‚úÖ –ü–û–î–ì–û–¢–û–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê. –í–´–ë–ï–†–ò–¢–ï –í–ê–†–ò–ê–ù–¢      ##
####################################################
#



######################################################
## üì¶ –ë–õ–û–ö 1: –í–´–ë–û–† –í–ê–†–ò–ê–ù–¢–ê –£–°–¢–ê–ù–û–í–ö–ò –î–†–ê–ô–í–ï–†–û–í    ##
######################################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞—à–µ–π –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–µ.
# ‚ùó –í–∞–∂–Ω–æ: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¢–û–õ–¨–ö–û –û–î–ò–ù –≤–∞—Ä–∏–∞–Ω—Ç –Ω–∏–∂–µ!
# üí° –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã. –£–±–µ—Ä–∏—Ç–µ '#' –ø–µ—Ä–µ–¥ –Ω—É–∂–Ω—ã–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏.

## === –í–ê–†–ò–ê–ù–¢ A: Intel Integrated Graphics ===##
# pacman -S --noconfirm mesa vulkan-intel lib32-mesa lib32-vulkan-intel vulkan-icd-loader lib32-vulkan-icd-loader

## === –í–ê–†–ò–ê–ù–¢ B: AMD Radeon Graphics –∏–ª–∏ Open-Source NVIDIA (nouveau) ===##
# pacman -S --noconfirm mesa vulkan-radeon lib32-mesa lib32-vulkan-radeon vulkan-icd-loader lib32-vulkan-icd-loader
# *(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≠—Ç–æ—Ç –∂–µ –Ω–∞–±–æ—Ä –ø–∞–∫–µ—Ç–æ–≤ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –¥—Ä–∞–π–≤–µ—Ä–æ–º nouveau –¥–ª—è GPU NVIDIA.)*

## === –í–ê–†–ò–ê–ù–¢ C: NVIDIA (–ü—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–µ –¥—Ä–∞–π–≤–µ—Ä—ã) ===##
# üìå –í–ê–ñ–ù–û: –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–≤–∞ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–∞: —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥—Ä–∞–π–≤–µ—Ä—ã.

# --- C1. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ GPU (Pascal, Turing, Ampere, Ada Lovelace –∏ –Ω–æ–≤–µ–µ): ---

# üí° –û–§–ò–¶–ò–ê–õ–¨–ù–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø NVIDIA (https://www.nvidia.com/drivers/  ):
# ¬´–ú–Ω–æ–≥–∏–µ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤—ã Linux –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –¥—Ä–∞–π–≤–µ—Ä–∞ NVIDIA
#  –¥–ª—è Linux –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ä–æ–¥–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞.
#  –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –º–æ–∂–µ—Ç –ª—É—á—à–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –æ—Å—Ç–∞–ª—å–Ω–æ–π —á–∞—Å—Ç—å—é
#  –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π —Å—Ä–µ–¥—ã –≤–∞—à–µ–≥–æ –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞, –∏ –≤–∞–º, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
#  –∏–º–µ–Ω–Ω–æ –µ–≥–æ, –∞ –Ω–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç –æ—Ç NVIDIA.¬ª

# üìå –í–ï–¢–ö–ò –î–†–ê–ô–í–ï–†–û–í:
# 1. **Production Branch / Studio Drivers**
#    - –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è –ë–û–õ–¨–®–ò–ù–°–¢–í–ê –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô.
#    - –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏
#      —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é ISV (–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ü–û).
#    - –î–ª–∏–Ω–Ω—ã–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
#    - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≠–¢–£ –í–ï–¢–ö–£, –µ—Å–ª–∏ –≤—ã –Ω–µ —É–≤–µ—Ä–µ–Ω—ã –≤ –≤—ã–±–æ—Ä–µ.
#
# 2. **New Feature Branch (NFB) / Game Ready Drivers**
#    - –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –ù–û–í–´–ï –§–£–ù–ö–¶–ò–ò, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–æ–∫
#      –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É –Ω–æ–≤—ã—Ö –û–° –º–µ–∂–¥—É —Ä–µ–ª–∏–∑–∞–º–∏ Production Branch.
#    - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≥–µ–π–º–µ—Ä–æ–≤ –∏ —Ä–∞–Ω–Ω–∏—Ö adopters.
#    - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ—Ä–æ—á–µ, —á–µ–º —É Production Branch.

# A. –î–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —è–¥—Ä–∞ (linux) ‚Äî Production Branch:
# pacman -S --noconfirm nvidia nvidia-utils nvidia-settings lib32-nvidia-utils opencl-nvidia lib32-opencl-nvidia

# B. –î–ª—è LTS-—è–¥—Ä–∞ (linux-lts) ‚Äî Production Branch:
# pacman -S --noconfirm nvidia-lts nvidia-utils nvidia-settings lib32-nvidia-utils opencl-nvidia lib32-opencl-nvidia

# C. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π DKMS-–¥—Ä–∞–π–≤–µ—Ä (–¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö —è–¥–µ—Ä) ‚Äî Production Branch:
# pacman -S --noconfirm nvidia-dkms nvidia-utils nvidia-settings lib32-nvidia-utils opencl-nvidia lib32-opencl-nvidia

# --- C2. –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ GPU (Tesla, Fermi, Kepler, Maxwell): ---

# *   –≠—Ç–∏ –¥—Ä–∞–π–≤–µ—Ä—ã –ù–ï –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö Arch.
# *   –ò—Ö –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏–∑ AUR. –ü—Ä–∏–º–µ—Ä—ã: `nvidia-390xx`, `nvidia-470xx`.
# *   –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `yay` –∏–ª–∏ –¥—Ä—É–≥–æ–π AUR helper.
# yay -S nvidia-390xx nvidia-390xx-utils nvidia-390xx-settings lib32-nvidia-390xx-utils opencl-nvidia-390xx lib32-opencl-nvidia-390xx# –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã –¥–ª—è AUR
# *(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø–∞–∫–µ—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, `nvidia-390xx` –¥–ª—è Fermi/Kepler, `nvidia-470xx` –¥–ª—è Maxwell.)*

# üìå –î–õ–Ø –ì–ò–ë–†–ò–î–ù–û–ô –ì–†–ê–§–ò–ö–ò (Intel/AMD + NVIDIA):
# pacman -S --noconfirm switcheroo-control
# systemctl enable switcheroo-control.service

# üìå –ï–°–õ–ò NVIDIA ‚Äî –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –í–ò–î–ï–û–ö–ê–†–¢–ê (–¢–û–õ–¨–ö–û –î–õ–Ø –°–û–í–†–ï–ú–ï–ù–ù–´–• GPU):
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ libva-nvidia-driver —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ.
# –ù–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –µ—ë –≤ —Å–∏—Å—Ç–µ–º–∞—Ö —Å –≥–∏–±—Ä–∏–¥–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–π!
# pacman -S --noconfirm libva-nvidia-driver


##########################################################
## üß∞ –ë–õ–û–ö 2: –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ì–†–ê–§–ò–ß–ï–°–ö–ò–ï –ë–ò–ë–õ–ò–û–¢–ï–ö–ò##   ##
##########################################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –û–±–µ—Å–ø–µ—á–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å Vulkan –∏ VA-API.
# üí° –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ GPU.

# Vulkan ICD Loader (–¥–ª—è –≤—Å–µ—Ö):
# pacman -S --noconfirm vulkan-icd-loader lib32-vulkan-icd-loader


#################################################
## üîß –ë–õ–û–ö 3: –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ú–û–î–£–õ–ï–ô –ò INITRAMFS ##
#################################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –º–æ–¥—Å–µ—Ç–∞ –¥–ª—è NVIDIA (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è Wayland).
# ‚ùó –í–∞–∂–Ω–æ: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤ (–ª—é–±–æ–π –≤–µ—Ç–∫–∏, –≤–∫–ª—é—á–∞—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ).
# üí° –≠—Ç–æ—Ç –±–ª–æ–∫ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏ –≤—ã –≤—ã–±—Ä–∞–ª–∏ –í–ê–†–ò–ê–ù–¢ C.

# === –¢–û–õ–¨–ö–û –î–õ–Ø NVIDIA (–ü–†–û–ü–†–ò–ï–¢–ê–†–ù–´–ï): –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥—É–ª–µ–π –∏ initramfs ===

# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥—É–ª—è NVIDIA:
#  'options nvidia-drm modeset=1' > /etc/modprobe.d/nvidia.conf
#  'options nvidia NVreg_DynamicPowerManagement=0x02' >> /etc/modprobe.d/nvidia.conf

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ initramfs (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!):
mkinitcpio -P


########################################################
## üîã –ë–õ–û–ö 4: –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û ‚Äî –ù–ê–°–¢–†–û–ô–ö–ò –î–õ–Ø –ù–û–£–¢–ë–£–ö–û–í   ##
########################################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –£–ª—É—á—à–∏—Ç—å —ç–Ω–µ—Ä–≥–æ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ –Ω–æ—É—Ç–±—É–∫–∞—Ö.
# üí° –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è TLP ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∏—Ç–∞–Ω–∏–µ–º.
# ‚ùó –í–ê–ñ–ù–û: –ï—Å–ª–∏ —É –≤–∞—Å –≥–∏–±—Ä–∏–¥–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ —Å NVIDIA, –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ TLP.

## === –¢–û–õ–¨–ö–û –î–õ–Ø –ù–û–£–¢–ë–£–ö–û–í (–ë–ï–ó –ì–ò–ë–†–ò–î–ù–û–ô –ì–†–ê–§–ò–ö–ò NVIDIA) ===
# pacman -S --noconfirm tlp tlp-rdw
# systemctl enable tlp.service
# systemctl mask systemd-rfkill.service systemd-rfkill.socket

## === –¢–û–õ–¨–ö–û –î–õ–Ø –ù–û–£–¢–ë–£–ö–û–í (–° –ì–ò–ë–†–ò–î–ù–û–ô –ì–†–ê–§–ò–ö–û–ô NVIDIA) ===
# pacman -S --noconfirm tlp tlp-rdw
## --- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TLP –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å NVIDIA ---
## 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ PCI-–∞–¥—Ä–µ—Å NVIDIA-–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã:
## lspci -nn | grep -i nvidia
## (–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞: 01:00.0 3D controller: NVIDIA Corporation TU104 [GeForce RTX 2080 Rev. A] [10de:1e82] (rev a1))
## (PCI ID: 10de:1e82, –ê–¥—Ä–µ—Å: 01:00.0)
## 2. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª TLP:
## nano /etc/tlp.conf
## –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É RUNTIME_PM_DENYLIST= –∏ –¥–æ–±–∞–≤—å—Ç–µ —Ç—É–¥–∞ **–∞–¥—Ä–µ—Å** –≤–∞—à–µ–π NVIDIA-–≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã (–≤ –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ `01:00.0`). –¢–∞–∫–∂–µ —á–∞—Å—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç –∞—É–¥–∏–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å dGPU (–Ω–∞–ø—Ä–∏–º–µ—Ä, `01:00.1`).
## RUNTIME_PM_DENYLIST=#01:00.0 01:00.1#
## –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª –∏ –∑–∞–∫—Ä–æ–π—Ç–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä.
## 3. –í–∫–ª—é—á–∏—Ç–µ —Å–ª—É–∂–±—É TLP:
## systemctl enable tlp.service
## systemctl mask systemd-rfkill.service systemd-rfkill.socket


#####################################################
## üß™ –ë–õ–û–ö 6: –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´ –ü–û–°–õ–ï –ü–ï–†–ï–ó–ê–ì–†–£–ó–ö–ò   ##
#####################################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥—Ä–∞–π–≤–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
# ‚ùó –í–∞–∂–Ω–æ: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É.
# üí° –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –æ—Ç –∏–º–µ–Ω–∏ –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã (–µ—Å–ª–∏ –µ—â—ë –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã):
# pacman -S --noconfirm mesa-utils vulkan-tools glmark2 mesa-demos libva-utils

# === –ü—Ä–æ–≤–µ—Ä–∫–∏: ===

# NVIDIA (–ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–µ):
# nvidia-smi

# Vulkan (–≤—Å–µ GPU):
# vulkaninfo --summary

# VA-API (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω libva-nvidia-driver –∏–ª–∏ nouveau):
# vainfo

# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ GPU (–≥–∏–±—Ä–∏–¥–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞):
# switcherooctl list
# switcherooctl launch --gpu 1 glxinfo | grep 'OpenGL renderer string'

# === –í–∏–∑—É–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã: ===
# glxgears       # –ë–∞–∑–æ–≤–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
# vkcube         # Vulkan-–∫—É–±
# glmark2        # OpenGL –±–µ–Ω—á–º–∞—Ä–∫
# switcherooctl launch --gpu 1 glmark2 # –ù–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ä—Ç–µ


##############################################
## üéÆ –ë–õ–û–ö 7: –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï SWITCHEROOCTL   ##
##############################################
#
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π –≤–∏–¥–µ–æ–∫–∞—Ä—Ç–µ –≤ Wayland.
# üí° –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å–µ–∞–Ω—Å.

# 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ ID –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–π GPU:
# switcherooctl list

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ GPU —Å ID=1 (–ø—Ä–∏–º–µ—Ä):
# switcherooctl launch --gpu 1 steam
# switcherooctl launch --gpu 1 vkcube
# switcherooctl launch --gpu 1 glmark2

# üí° –°–æ–≤–µ—Ç: –î–ª—è –∏–≥—Ä –∏ —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ switcherooctl –≤ Wayland.

#
#############################################
## ‚úÖ –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –î–†–ê–ô–í–ï–†–ê–ú –ó–ê–í–ï–†–®–ï–ù–û   ##
#############################################
#
