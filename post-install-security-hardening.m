
# ==============================================================================
# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ë–∞–∑–æ–≤–æ–µ —É–ø—Ä–æ—á–Ω–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ Arch Linux
# –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å BTRFS + LVM + LUKS + snapper + btrfs-assistant
# –í—ã–ø–æ–ª–Ω—è—Ç—å –í–†–£–ß–ù–£–Æ, –ø–æ —à–∞–≥–∞–º, –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å sudo.
# –ê–≤—Ç–æ—Ä: rublev
# –î–∞—Ç–∞: 2026-01-06
# ==============================================================================

# ----------------------------------------------------------------------------
# –®–ê–ì 1: –û—Ç–∫–ª—é—á–µ–Ω–∏–µ kexec ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —è–¥—Ä–∞ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
# ----------------------------------------------------------------------------
# ‚ÑπÔ∏è –ó–∞—á–µ–º: kexec –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤–æ–µ —è–¥—Ä–æ –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ä–µ–∂–∏–º–∞,
#          –º–∏–Ω—É—è –∑–∞–≥—Ä—É–∑—á–∏–∫ –∏ LUKS. –≠—Ç–æ –æ–±—Ö–æ–¥ –∑–∞—â–∏—Ç—ã –ø—Ä–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º –¥–æ—Å—Ç—É–ø–µ.
# üí° –†–∏—Å–∫: –°—Ä–µ–¥–Ω–∏–π (—Ç—Ä–µ–±—É–µ—Ç root, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ APT-–∞—Ç–∞–∫–∞—Ö).
# ‚úÖ –†–µ—à–µ–Ω–∏–µ: –û—Ç–∫–ª—é—á–∏—Ç—å kexec –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞.

echo 'kernel.kexec_load_disabled=1' | sudo tee /etc/sysctl.d/50-kexec.conf

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
# cat /etc/sysctl.d/50-kexec.conf

# ----------------------------------------------------------------------------
# –®–ê–ì 2: –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞ .snapshots –∏–∑ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ —É—Ç–∏–ª–∏—Ç–∞–º–∏ locate/mlocate
# ----------------------------------------------------------------------------
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –ö–∞—Ç–∞–ª–æ–≥ /.snapshots —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã.
#          –ï–≥–æ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è:
#            - —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å–Ω–∞–ø—à–æ—Ç–æ–≤ (—É—Ç–µ—á–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏),
#            - –∑–∞–º–µ–¥–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã locate,
#            - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ª–æ–∂–Ω—ã–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è–º –ø—Ä–∏ –ø–æ–∏—Å–∫–µ.
# üí° –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ snapper, grub-btrfs –∏–ª–∏ btrfs-assistant.

echo 'PRUNENAMES=".snapshots"' | sudo tee -a /etc/updatedb.conf

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
# grep -E 'PRUNENAMES.*\.snapshots' /etc/updatedb.conf

# ----------------------------------------------------------------------------
# –®–ê–ì 3: –ó–∞–ø—Ä–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ core-–¥–∞–º–ø–æ–≤ ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏
# ----------------------------------------------------------------------------
# ‚ÑπÔ∏è –ó–∞—á–µ–º: Core-–¥–∞–º–ø—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –¥–∞–º–ø –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–∏ –∞–≤–∞—Ä–∏–π–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏.
#          –í –Ω–∏—Ö –º–æ–≥—É—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –ø–∞—Ä–æ–ª–∏, –∫–ª—é—á–∏, —Ç–æ–∫–µ–Ω—ã.
# üí° –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –Ω–∞ —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏—è—Ö —Å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

echo '* hard core 0' | sudo tee -a /etc/security/limits.conf

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
# grep 'hard core 0' /etc/security/limits.conf

# ----------------------------------------------------------------------------
# –®–ê–ì 4: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö sysctl-–Ω–∞—Å—Ç—Ä–æ–µ–∫ (–≤–∫–ª—é—á–∞—è kexec)
# ----------------------------------------------------------------------------
# ‚ÑπÔ∏è –ó–∞—á–µ–º: –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ /etc/sysctl.d/ –≤—Å—Ç—É–ø–∏–ª–∏ –≤ —Å–∏–ª—É –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.

sudo sysctl --system

# ----------------------------------------------------------------------------
# –ì–û–¢–û–í–û.
# ----------------------------------------------------------------------------
# –≠—Ç–∏ –º–µ—Ä—ã:
#   ‚úÖ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å snapper –∏ btrfs-assistant,
#   ‚úÖ –Ω–µ –ª–æ–º–∞—é—Ç LUKS/LVM/Btrfs –∏–ª–∏ GRUB,
#   ‚úÖ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å UEFI –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Å–Ω–∞–ø—à–æ—Ç–∞–º–∏.
#
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ë–õ–û–ö–ê 16 –≤–∞—à–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏.
# ==============================================================================
